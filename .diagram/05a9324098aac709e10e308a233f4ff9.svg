<svg xmlns="http://www.w3.org/2000/svg" width="1002" height="692" preserveAspectRatio="none" style="width:1002px;height:692px;background:#fff"><defs><filter id="a" width="1" height="1" x="0" y="0"><feFlood flood-color="orange" result="flood"/><feComposite in="SourceGraphic" in2="flood"/></filter><filter id="b" width="1" height="1" x="0" y="0"><feFlood flood-color="#FF0" result="flood"/><feComposite in="SourceGraphic" in2="flood"/></filter></defs><rect width="62" height="36.297" x="10" y="327.148" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="20" y="350.144" font-family="sans-serif" font-size="14" textLength="42">持久化</text><rect width="164" height="36.297" x="122" y="37.594" fill="#FBC" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="132" y="60.589" font-family="sans-serif" font-size="14" textLength="140">直接挂载卷存在的问题</text><text x="339" y="23.995" font-family="sans-serif" font-size="14" textLength="343">当某个数据卷不再被挂载使用时，里面的数据如何处理?</text><path fill="none" d="M286 55.742h10c15 0 15-36.594 30-36.594h10" style="stroke:#181818;stroke-width:1"/><text x="339" y="42.292" font-family="sans-serif" font-size="14" textLength="119">如何实现只读挂载?</text><path fill="none" d="M286 55.742h10c15 0 15-18.297 30-18.297h10" style="stroke:#181818;stroke-width:1"/><text x="339" y="60.589" font-family="sans-serif" font-size="14" textLength="174">如何实现只让一个Pod挂载?</text><path fill="none" d="M286 55.742h50" style="stroke:#181818;stroke-width:1"/><text x="339" y="78.886" font-family="sans-serif" font-size="14" textLength="231">如何只允许某个Pod使用10G的空间?</text><path fill="none" d="M286 55.742h10c15 0 15 18.297 30 18.297h10" style="stroke:#181818;stroke-width:1"/><text x="339" y="97.183" font-family="sans-serif" font-size="14" textLength="497">其他开发人员想要用? 能不能很简单的搞起来? 得叫运维人员帮忙创建 几个pv先?</text><path fill="none" d="M286 55.742h10c15 0 15 36.594 30 36.594h10M72 345.297h10c15 0 15-289.555 30-289.555h10" style="stroke:#181818;stroke-width:1"/><rect width="115" height="36.297" x="122" y="372.891" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="132" y="395.886" font-family="sans-serif" font-size="14" textLength="95">k8s的解决方案</text><rect width="40" height="36.297" x="287" y="176.969" fill="#90EE90" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="297" y="199.964" font-family="sans-serif" font-size="14" textLength="16">pv</text><text x="380" y="115.48" font-family="sans-serif" font-size="14" textLength="126">Persistent Volume</text><text x="380" y="131.776" font-family="sans-serif" font-size="14" textLength="4"> </text><path fill="none" d="M327 195.117h10c15 0 15-76.336 30-76.336h10" style="stroke:#181818;stroke-width:1"/><text x="380" y="150.073" font-family="sans-serif" font-size="14" textLength="228">代表着集群中的一个持久化存储资源,</text><text x="380" y="166.37" font-family="sans-serif" font-size="14" textLength="304">比如理解为一块5G的&quot;磁盘&quot;,这样的可以创建很多,</text><text x="380" y="182.667" font-family="sans-serif" font-size="14" textLength="350">它可以是物理存储设备、网络存储卷、云提供商的存储等</text><text x="380" y="198.964" font-family="sans-serif" font-size="14" textLength="4"> </text><path fill="none" d="M327 195.117h10c15 0 15-25.445 30-25.445h10" style="stroke:#181818;stroke-width:1"/><text x="380" y="217.261" font-family="sans-serif" font-size="14" textLength="281">PV 是集群中的一个独立实体，与 Pod 解耦，</text><text x="380" y="233.558" font-family="sans-serif" font-size="14" textLength="203">可以独立于 Pod 的生命周期存在</text><text x="380" y="249.855" font-family="sans-serif" font-size="14" textLength="4"> </text><path fill="none" d="M327 195.117h10c15 0 15 33.594 30 33.594h10" style="stroke:#181818;stroke-width:1"/><text x="380" y="268.151" font-family="sans-serif" font-size="14" textLength="294">能够设置这块&quot;磁盘&quot;创建时的访问权限,大小等等</text><text x="380" y="284.448" font-family="sans-serif" font-size="14" textLength="4"> </text><path fill="none" d="M327 195.117h10c15 0 15 76.336 30 76.336h10M237 391.04h10c15 0 15-195.923 30-195.923h10" style="stroke:#181818;stroke-width:1"/><rect width="48" height="36.297" x="287" y="390.68" fill="#FF0" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="297" y="413.675" font-family="sans-serif" font-size="14" textLength="24">pvc</text><text x="392" y="302.745" font-family="sans-serif" font-size="14" textLength="167">Persistent Volume Claim</text><text x="388" y="319.042" font-family="sans-serif" font-size="14" textLength="4"> </text><path fill="none" d="M335 408.828h10c15 0 15-102.781 30-102.781h10" style="stroke:#181818;stroke-width:1"/><text x="388" y="337.339" font-family="sans-serif" font-size="14" textLength="291">是Pod 对 PV 的请求, 定义了你需要什么样的pv</text><text x="732" y="319.042" font-family="sans-serif" font-size="14" textLength="56">存储容量</text><path fill="none" d="M679 332.492h10c15 0 15-18.297 30-18.297h10" style="stroke:#181818;stroke-width:1"/><text x="732" y="337.339" font-family="sans-serif" font-size="14" textLength="56">访问模式</text><path fill="none" d="M679 332.492h50" style="stroke:#181818;stroke-width:1"/><text x="732" y="355.636" font-family="sans-serif" font-size="14" textLength="84">等等其他属性</text><path fill="none" d="M679 332.492h10c15 0 15 18.297 30 18.297h10M335 408.828h10c15 0 15-76.336 30-76.336h10" style="stroke:#181818;stroke-width:1"/><text x="388" y="373.933" font-family="sans-serif" font-size="14" textLength="424">Pod yaml文件里指定一个 PVC 来声明对持久化存储有什么样的需求,</text><text x="388" y="390.229" font-family="sans-serif" font-size="14" textLength="106">不去管具体的 PV</text><text x="388" y="406.526" font-family="sans-serif" font-size="14" textLength="4"> </text><path fill="none" d="M335 408.828h10c15 0 15-23.445 30-23.445h10" style="stroke:#181818;stroke-width:1"/><text x="388" y="424.823" filter="url(#a)" font-family="sans-serif" font-size="14" textLength="228">k8s 会根据你pod设置的PVC的定义,</text><text x="388" y="441.12" filter="url(#a)" font-family="sans-serif" font-size="14" textLength="208">会自动匹配并绑定一个合适的 PV,</text><text x="388" y="457.417" filter="url(#a)" font-family="sans-serif" font-size="14" textLength="352">然后将该 PV 挂载到 Pod 中,使 Pod 可以使用持久化存储</text><text x="388" y="473.714" font-family="sans-serif" font-size="14" textLength="4"> </text><path fill="none" d="M335 408.828h10c15 0 15 35.594 30 35.594h10" style="stroke:#181818;stroke-width:1"/><text x="388" y="492.011" font-family="sans-serif" font-size="14" textLength="536">PVC 充当了 Pod 和 PV 之间的中间层, 它将 Pod 与实际的持久化存储资源（PV）解耦,</text><text x="388" y="508.308" font-family="sans-serif" font-size="14" textLength="251">Pod 只要申明你的需求即可, 不用关心pv</text><text x="388" y="524.605" font-family="sans-serif" font-size="14" textLength="4"> </text><path fill="none" d="M335 408.828h10c15 0 15 94.633 30 94.633h10M237 391.04h10c15 0 15 17.788 30 17.788h10" style="stroke:#181818;stroke-width:1"/><rect width="114" height="36.297" x="287" y="586.602" fill="gold" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="297" y="609.597" font-family="sans-serif" font-size="14" textLength="90">storageClass</text><rect width="48" height="36.297" x="451" y="555.664" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="461" y="578.659" font-family="sans-serif" font-size="14" textLength="28">目的</text><text x="552" y="542.901" font-family="sans-serif" font-size="14" textLength="314">解决来一个存储需求,就需要手动创建一个pv的问题</text><path fill="none" d="M499 573.813h10c15 0 15-35.758 30-35.758h10" style="stroke:#181818;stroke-width:1"/><text x="552" y="563.055" font-family="sans-serif" font-size="16" font-weight="bold" textLength="85">动态创建pv</text><path fill="none" d="M499 573.813h10c15 0 15-16.297 30-16.297h10" style="stroke:#181818;stroke-width:1"/><text x="552" y="581.823" font-family="sans-serif" font-size="14" textLength="362">还可以当成pv的一种类型,pvc选择这种类型的pv,做过滤用,</text><text x="552" y="598.12" font-family="sans-serif" font-size="14" textLength="188">不需要有真实的storageClass</text><text x="552" y="614.417" font-family="sans-serif" font-size="14" textLength="4"> </text><path fill="none" d="M499 573.813h10c15 0 15 19.46 30 19.46h10M401 604.75h10c15 0 15-30.937 30-30.937h10" style="stroke:#181818;stroke-width:1"/><rect width="76" height="36.297" x="451" y="631.508" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="461" y="654.503" font-family="sans-serif" font-size="14" textLength="56">实现方案</text><text x="580" y="632.714" font-family="sans-serif" font-size="14" textLength="372">pvc 指定 storageClassName ,表示选择哪个storageClass</text><path fill="none" d="M527 649.656h10c15 0 15-21.789 30-21.789h10" style="stroke:#181818;stroke-width:1"/><text x="580" y="651.011" font-family="sans-serif" font-size="14" textLength="118">创建storageClass</text><path fill="none" d="M527 649.656h10c15 0 15-3.492 30-3.492h10" style="stroke:#181818;stroke-width:1"/><text x="580" y="676.292" font-family="sans-serif" font-size="14" textLength="146">与storageClass关联的</text><text x="726" y="674.877" filter="url(#b)" font-family="sans-serif" font-size="20" textLength="150">Provisioner组件</text><text x="876" y="676.292" font-family="sans-serif" font-size="14" textLength="114">来实现动态创建pv</text><path fill="none" d="M527 649.656h10c15 0 15 18.297 30 18.297h10M401 604.75h10c15 0 15 44.906 30 44.906h10M237 391.04h10c15 0 15 213.71 30 213.71h10M72 345.297h10c15 0 15 45.742 30 45.742h10" style="stroke:#181818;stroke-width:1"/></svg>