<svg xmlns="http://www.w3.org/2000/svg" width="849" height="348" preserveAspectRatio="none" style="width:849px;height:348px;background:#fff"><defs><filter id="a" width="300%" height="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"/><feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3"/></filter></defs><text x="777" y="19.282" fill="#888" font-family="sans-serif" font-size="10" textLength="52">made by x</text><text x="279.5" y="45.636" font-family="sans-serif" font-size="14" font-weight="bold" textLength="280">为了实现无GC,内存可自动回收而设计的方案</text><rect width="94" height="40.297" x="10" y="168.531" fill="#A8EB99" filter="url(#a)" rx="7.5" ry="7.5" style="stroke:#000;stroke-width:1"/><text x="22" y="193.526" font-family="sans-serif" font-size="14" textLength="70">所有权规则</text><rect width="364" height="40.297" x="154" y="69.938" fill="#FFFFE0" filter="url(#a)" rx="7.5" ry="7.5" style="stroke:#000;stroke-width:1"/><text x="166" y="94.933" font-family="sans-serif" font-size="14" textLength="340">每个值都有一个变量来负责它,该变量就是该值的所有者</text><path fill="none" d="M104 188.68h10c15 0 15-98.594 30-98.594h10" style="stroke:green;stroke-width:1;stroke-dasharray:5,5"/><rect width="206" height="40.297" x="154" y="130.234" fill="#FFFFE0" filter="url(#a)" rx="7.5" ry="7.5" style="stroke:#000;stroke-width:1"/><text x="166" y="155.23" font-family="sans-serif" font-size="14" textLength="182">每个值同时只能有一个所有者</text><path fill="none" d="M104 188.68h10c15 0 15-38.297 30-38.297h10" style="stroke:green;stroke-width:1;stroke-dasharray:5,5"/><rect width="150" height="40.297" x="154" y="228.828" fill="#FFFFE0" filter="url(#a)" rx="7.5" ry="7.5" style="stroke:#000;stroke-width:1"/><text x="166" y="253.823" font-family="sans-serif" font-size="14" textLength="126">当变量离开作用域时</text><rect width="476" height="40.297" x="354" y="190.531" fill="gold" filter="url(#a)" rx="7.5" ry="7.5" style="stroke:#000;stroke-width:1"/><text x="366" y="215.526" font-family="sans-serif" font-size="14" textLength="452">如果该变量除了栈上分配的内存还有指向堆内存的数据,那么会回收堆内存</text><path fill="none" d="M304 248.977h10c15 0 15-38.297 30-38.297h10" style="stroke:red;stroke-width:1;stroke-dasharray:5,5"/><rect width="384" height="56.594" x="354" y="250.828" fill="gold" filter="url(#a)" rx="7.5" ry="7.5" style="stroke:#000;stroke-width:1"/><text x="366" y="275.823" font-family="sans-serif" font-size="14" textLength="360">变量本身在栈上分配的内存不会说栈指针往前移动来&quot;回收&quot;</text><text x="413" y="292.12" font-family="sans-serif" font-size="14" textLength="266">在函数调用完毕返回后,才会&quot;回收&quot;整个栈帧</text><path fill="none" d="M304 248.977h10c15 0 15 30.148 30 30.148h10" style="stroke:red;stroke-width:1;stroke-dasharray:5,5"/><path fill="none" d="M104 188.68h10c15 0 15 60.297 30 60.297h10" style="stroke:green;stroke-width:1;stroke-dasharray:5,5"/><text x="406" y="331.417" font-family="sans-serif" font-size="14" textLength="27">图 2</text></svg>