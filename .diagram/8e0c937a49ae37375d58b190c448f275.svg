<svg xmlns="http://www.w3.org/2000/svg" width="1471" height="732" preserveAspectRatio="none" style="width:1471px;height:732px;background:#fff"><rect width="45" height="36.297" x="10" y="347.102" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="20" y="370.097" font-family="sans-serif" font-size="14" textLength="25">k8s</text><rect width="145" height="36.297" x="105" y="20" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="115" y="42.995" font-family="sans-serif" font-size="14" textLength="125">kubectl 命令行工具</text><text x="303" y="33.847" font-family="sans-serif" font-size="14" textLength="345">kubectl以命令行交互的方式对k8s API Server进行操作</text><path fill="none" d="M250 38.148h10c15 0 15-9.148 30-9.148h10" style="stroke:#181818;stroke-width:1"/><text x="303" y="52.144" font-family="sans-serif" font-size="14" textLength="408">发送http请求,kube-apiserver 接收请求,处理,返回结果给kubectl</text><path fill="none" d="M250 38.148h10c15 0 15 9.149 30 9.149h10M55 365.25h10c15 0 15-327.102 30-327.102h10" style="stroke:#181818;stroke-width:1"/><rect width="112" height="36.297" x="105" y="184.078" fill="#FF0" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="115" y="207.073" font-family="sans-serif" font-size="14" textLength="88">master node</text><rect width="127" height="36.297" x="267" y="84.742" fill="#FBC" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="277" y="107.737" font-family="sans-serif" font-size="14" textLength="103">kube-apiserver</text><text x="447" y="80.292" font-family="sans-serif" font-size="14" textLength="289">集群的HTTP REST API接口,是集群控制的入口</text><path fill="none" d="M394 102.89h10c15 0 15-27.445 30-27.445h10" style="stroke:#181818;stroke-width:1"/><text x="447" y="98.589" font-family="sans-serif" font-size="14" textLength="456">将k8s &quot;资源组/资源版本/资源&quot; 以RESTful风格的形式对外暴露并提供服务</text><path fill="none" d="M394 102.89h10c15 0 15-9.148 30-9.148h10" style="stroke:#181818;stroke-width:1"/><text x="447" y="116.886" font-family="sans-serif" font-size="14" textLength="608">k8s集群中的所有组件都通过kube-apiserver组件操作资源对象,也通过它让各组件可以通信和交互</text><path fill="none" d="M394 102.89h10c15 0 15 9.15 30 9.15h10" style="stroke:#181818;stroke-width:1"/><text x="447" y="135.183" font-family="sans-serif" font-size="14" textLength="428">kube-apiserver组件也是集群中唯一与Etcd集群进行交互的核心组件</text><path fill="none" d="M394 102.89h10c15 0 15 27.446 30 27.446h10M217 202.227h10c15 0 15-99.336 30-99.336h10" style="stroke:#181818;stroke-width:1"/><rect width="191" height="36.297" x="267" y="184.078" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="277" y="207.073" font-family="sans-serif" font-size="14" textLength="171">kube-controller-manager</text><text x="511" y="153.48" font-family="sans-serif" font-size="14" textLength="238">集群中所有资源对象的自动化控制中心</text><path fill="none" d="M458 202.227h10c15 0 15-53.594 30-53.594h10" style="stroke:#181818;stroke-width:1"/><rect width="90" height="36.297" x="508" y="167.781" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="518" y="190.776" font-family="sans-serif" font-size="14" textLength="70">各种控制器</text><text x="651" y="172.48" font-family="sans-serif" font-size="14" textLength="123">namespace控制器</text><path fill="none" d="M598 185.93h10c15 0 15-18.297 30-18.297h10" style="stroke:#181818;stroke-width:1"/><text x="651" y="190.776" font-family="sans-serif" font-size="14" textLength="124">deployment控制器</text><path fill="none" d="M598 185.93h50" style="stroke:#181818;stroke-width:1"/><text x="651" y="209.073" font-family="sans-serif" font-size="14" textLength="12">...</text><path fill="none" d="M598 185.93h10c15 0 15 18.297 30 18.297h10M458 202.227h10c15 0 15-16.297 30-16.297h10" style="stroke:#181818;stroke-width:1"/><text x="515" y="228.073" font-family="sans-serif" font-size="14" textLength="525">每个控制器通过apiserver组件提供的接口实时监控整个集群每个资源对象的当前状态</text><text x="511" y="244.37" font-family="sans-serif" font-size="14" textLength="284">当因发生各种故障而导致系统状态出现变化时,</text><text x="511" y="260.667" font-family="sans-serif" font-size="14" textLength="220">会尝试将系统状态修复到&quot;期望状态&quot;</text><path fill="none" d="M458 202.227h10c15 0 15 37.296 30 37.296h10M217 202.227h50" style="stroke:#181818;stroke-width:1"/><rect width="129" height="36.297" x="267" y="283.414" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="277" y="306.409" font-family="sans-serif" font-size="14" textLength="109">kube-scheduler</text><text x="449" y="278.964" font-family="sans-serif" font-size="14" textLength="195">集群中Pod资源对象的调度服务</text><path fill="none" d="M396 301.563h10c15 0 15-27.446 30-27.446h10" style="stroke:#181818;stroke-width:1"/><text x="449" y="297.261" font-family="sans-serif" font-size="14" textLength="209">一个Pod资源对象找到合适的节点</text><path fill="none" d="M396 301.563h10c15 0 15-9.149 30-9.149h10" style="stroke:#181818;stroke-width:1"/><text x="449" y="315.558" font-family="sans-serif" font-size="14" textLength="223">调度器每次只调度一个Pod资源对象</text><path fill="none" d="M396 301.563h10c15 0 15 9.148 30 9.148h10" style="stroke:#181818;stroke-width:1"/><text x="449" y="333.854" font-family="sans-serif" font-size="14" textLength="288">监控整个集群的Pod资源对象和Node资源对象</text><path fill="none" d="M396 301.563h10c15 0 15 27.445 30 27.445h10M217 202.227h10c15 0 15 99.336 30 99.336h10M55 365.25h10c15 0 15-163.023 30-163.023h10" style="stroke:#181818;stroke-width:1"/><rect width="111" height="36.297" x="105" y="511.18" fill="#ADD8E6" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="115" y="534.175" font-family="sans-serif" font-size="14" textLength="87">worker node</text><rect width="72" height="36.297" x="266" y="439.289" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="276" y="462.284" font-family="sans-serif" font-size="14" textLength="52">kubelet</text><text x="391" y="352.151" font-family="sans-serif" font-size="14" textLength="498">负责管理节点上pod资源对象的创建、删除、启停等任务,与Master节点进行通信</text><path fill="none" d="M338 457.438h10c15 0 15-110.133 30-110.133h10" style="stroke:#181818;stroke-width:1"/><text x="391" y="370.448" font-family="sans-serif" font-size="14" textLength="313">接收、处理、上报kube-apiserver组件下发的任务</text><path fill="none" d="M338 457.438h10c15 0 15-91.836 30-91.836h10" style="stroke:#181818;stroke-width:1"/><rect width="141" height="36.297" x="388" y="457.586" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="398" y="480.581" font-family="sans-serif" font-size="14" textLength="121">实现了3种开放接口</text><rect width="43" height="36.297" x="579" y="393.195" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="589" y="416.19" font-family="sans-serif" font-size="14" textLength="23">CRI</text><text x="675" y="388.745" font-family="sans-serif" font-size="14" textLength="295">Container Runtime Interface 容器运行时接口</text><path fill="none" d="M622 411.344h10c15 0 15-27.446 30-27.446h10" style="stroke:#181818;stroke-width:1"/><text x="675" y="407.042" font-family="sans-serif" font-size="14" textLength="210">提供容器运行时通用插件接口服务</text><path fill="none" d="M622 411.344h10c15 0 15-9.149 30-9.149h10" style="stroke:#181818;stroke-width:1"/><text x="675" y="425.339" font-family="sans-serif" font-size="14" textLength="182">定义了容器和镜像服务的接口</text><path fill="none" d="M622 411.344h10c15 0 15 9.148 30 9.148h10" style="stroke:#181818;stroke-width:1"/><text x="675" y="443.636" font-family="sans-serif" font-size="14" textLength="784">将原来完全面向Pod级别的内部接口拆分成面向Sandbox和Container的gRPC接口,并将镜像管理和容器管理分离给不同的服务</text><path fill="none" d="M622 411.344h10c15 0 15 27.445 30 27.445h10M529 475.734h10c15 0 15-64.39 30-64.39h10" style="stroke:#181818;stroke-width:1"/><rect width="43" height="36.297" x="579" y="466.383" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="589" y="489.378" font-family="sans-serif" font-size="14" textLength="23">CNI</text><text x="675" y="461.933" font-family="sans-serif" font-size="14" textLength="280">Container Network Interface 容器网络接口</text><path fill="none" d="M622 484.531h10c15 0 15-27.445 30-27.445h10" style="stroke:#181818;stroke-width:1"/><text x="675" y="480.229" font-family="sans-serif" font-size="14" textLength="168">提供网络通用插件接口服务</text><path fill="none" d="M622 484.531h10c15 0 15-9.148 30-9.148h10" style="stroke:#181818;stroke-width:1"/><text x="675" y="498.526" font-family="sans-serif" font-size="14" textLength="205">容器创建时通过CNI插件配置网络</text><path fill="none" d="M622 484.531h10c15 0 15 9.149 30 9.149h10" style="stroke:#181818;stroke-width:1"/><text x="675" y="516.823" font-family="sans-serif" font-size="14" textLength="163">插件目录: /etc/cni/net.d/</text><path fill="none" d="M622 484.531h10c15 0 15 27.446 30 27.446h10M529 475.734h10c15 0 15 8.797 30 8.797h10" style="stroke:#181818;stroke-width:1"/><rect width="42" height="36.297" x="579" y="530.422" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="589" y="553.417" font-family="sans-serif" font-size="14" textLength="22">CSI</text><text x="674" y="535.12" font-family="sans-serif" font-size="14" textLength="277">Container Storage Interface 容器存储接口</text><path fill="none" d="M621 548.57h10c15 0 15-18.297 30-18.297h10" style="stroke:#181818;stroke-width:1"/><text x="674" y="553.417" font-family="sans-serif" font-size="14" textLength="168">提供存储通用插件接口服务</text><path fill="none" d="M621 548.57h50" style="stroke:#181818;stroke-width:1"/><text x="674" y="571.714" font-family="sans-serif" font-size="14" textLength="218">容器创建时通过CSI插件配置存储卷</text><path fill="none" d="M621 548.57h10c15 0 15 18.297 30 18.297h10M529 475.734h10c15 0 15 72.836 30 72.836h10M338 457.438h10c15 0 15 18.296 30 18.296h10M216 529.328h10c15 0 15-71.89 30-71.89h10" style="stroke:#181818;stroke-width:1"/><rect width="97" height="36.297" x="266" y="602.313" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="276" y="625.308" font-family="sans-serif" font-size="14" textLength="77">kube-proxy</text><text x="416" y="590.714" font-family="sans-serif" font-size="14" textLength="277">负责Kubernetes服务的通信及负载均衡服务</text><path fill="none" d="M363 620.46h10c15 0 15-34.593 30-34.593h10" style="stroke:#181818;stroke-width:1"/><text x="420" y="609.011" font-family="sans-serif" font-size="14" textLength="275">监控kube-apiserver的服务和端点资源变化,</text><text x="416" y="625.308" font-family="sans-serif" font-size="14" textLength="244">并通过iptables/ipvs等配置负载均衡器,</text><text x="416" y="641.605" font-family="sans-serif" font-size="14" textLength="356">为一组Pod提供统一的TCP/UDP流量转发和负载均衡功能</text><path fill="none" d="M363 620.46h50" style="stroke:#181818;stroke-width:1"/><text x="416" y="659.901" font-family="sans-serif" font-size="14" textLength="557">相当于代理模型,对于某个IP:Port的请求,负责将其转发给专用网络上的相应服务或应用程序</text><path fill="none" d="M363 620.46h10c15 0 15 34.595 30 34.595h10M216 529.328h10c15 0 15 91.133 30 91.133h10" style="stroke:#181818;stroke-width:1"/><rect width="113" height="36.297" x="266" y="674.203" fill="#F1F1F1" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5"/><text x="276" y="697.198" font-family="sans-serif" font-size="14" textLength="93">container组件</text><text x="432" y="697.198" font-family="sans-serif" font-size="14" textLength="322">负责容器的基础管理服务,接收kubelet组件的指令。</text><path fill="none" d="M379 692.352h50M216 529.328h10c15 0 15 163.024 30 163.024h10M55 365.25h10c15 0 15 164.078 30 164.078h10" style="stroke:#181818;stroke-width:1"/></svg>